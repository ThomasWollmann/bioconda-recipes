#!/bin/bash

mkdir build
cd build

export LIBRARY_DIR='${PREFIX}/lib'
export INCLUDE_DIR='${PREFIX}/include'

cmake \
    -D CMAKE_INSTALL_PREFIX=${PREFIX} \
    -D CMAKE_INSTALL_RPATH:STRING=${PREFIX}/lib \
    -D CMAKE_BUILD_TYPE=Release \
    -D BUILD_DIAG_PATHOLOGY_EXECUTABLES:BOOL=ON \
    -D BUILD_DIAG_PATHOLOGY_WORKSTATION:BOOL=ON \
    -D BUILD_DIAG_PATHOLOGY_IMAGEPROCESSING:BOOL=ON \
    -D DCMTKJPEG_LIBRARY:STRING=${LIBRARY_DIR} \
    -D DCMTKJPEG_INCLUDE_DIR:STRING=${INCLUDE_DIR} \    
    -D OPENSLIDE_LIBRARY:STRING=${LIBRARY_DIR} \
    -D OPENSLIDE_INCLUDE_DIR:STRING=${INCLUDE_DIR} \
      ..

make -j$CPU_COUNT
make install
